<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Essen mit Herz Scanner</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;600;700;800&family=Playfair+Display:ital,wght@0,700;1,400&display=swap" rel="stylesheet">
<style>
:root {
  --dark: #1B2838;
  --dark-soft: #2A3A4A;
  --primary: #C8956C;
  --primary-light: #E8C9A8;
  --primary-glow: rgba(200,149,108,0.15);
  --cream: #FBF8F4;
  --warm-white: #FFFFFF;
  --text: #1B2838;
  --text-muted: #7A8694;
  --border: #E8E2DA;
  --tier-top: #3D8B6E;
  --tier-top-bg: #E8F5EE;
  --tier-ok: #C8956C;
  --tier-ok-bg: #FDF3EB;
  --tier-uncool: #CB6B4A;
  --tier-uncool-bg: #FDEEE8;
  --tier-nogo: #943338;
  --tier-nogo-bg: #FCEAEB;
  --radius: 14px;
  --radius-sm: 8px;
  --shadow-card: 0 1px 3px rgba(27,40,56,0.06), 0 4px 12px rgba(27,40,56,0.04);
  --shadow-elevated: 0 4px 20px rgba(27,40,56,0.1), 0 1px 4px rgba(27,40,56,0.06);
}

* { margin:0; padding:0; box-sizing:border-box; }

body {
  font-family: 'Manrope', -apple-system, sans-serif;
  background: #E8E2DA;
  color: var(--text);
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  padding: 20px;
}

/* Phone Frame */
.phone-frame {
  width: 375px;
  height: 812px;
  background: var(--cream);
  border-radius: 40px;
  box-shadow:
    0 0 0 3px var(--dark),
    0 20px 60px rgba(27,40,56,0.25),
    inset 0 0 0 1px rgba(255,255,255,0.1);
  overflow: hidden;
  position: relative;
  display: flex;
  flex-direction: column;
}

@media (max-width: 420px) {
  .phone-frame {
    width: 100%;
    height: 100vh;
    border-radius: 0;
    box-shadow: none;
  }
  body { padding: 0; background: var(--cream); }
}

/* Notch */
.phone-frame::before {
  content: '';
  position: absolute;
  top: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 150px;
  height: 28px;
  background: var(--dark);
  border-radius: 0 0 20px 20px;
  z-index: 100;
}

/* Status Bar */
.status-bar {
  height: 48px;
  background: var(--dark);
  display: flex;
  justify-content: space-between;
  align-items: flex-end;
  padding: 0 24px 6px;
  color: white;
  font-size: 12px;
  font-weight: 600;
  flex-shrink: 0;
}
.status-bar-right { display:flex; gap:5px; align-items:center; }
.status-bar-right svg { width:14px; height:14px; }

/* Screens Container */
.screens {
  flex: 1;
  overflow: hidden;
  position: relative;
}

.screen {
  position: absolute;
  top: 0; left: 0;
  width: 100%;
  height: 100%;
  overflow-y: auto;
  background: var(--cream);
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s ease, transform 0.3s ease;
  transform: translateY(8px);
  -webkit-overflow-scrolling: touch;
}
.screen.active {
  opacity: 1;
  pointer-events: auto;
  transform: translateY(0);
}

/* Bottom Nav */
.bottom-nav {
  display: flex;
  background: var(--warm-white);
  border-top: 1px solid var(--border);
  padding: 6px 0 28px;
  flex-shrink: 0;
}
.nav-item {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
  padding: 8px 0 0;
  cursor: pointer;
  color: var(--text-muted);
  transition: color 0.2s;
  -webkit-tap-highlight-color: transparent;
  background: none;
  border: none;
  font-family: inherit;
}
.nav-item:hover { color: var(--dark-soft); }
.nav-item.active { color: var(--primary); }
.nav-item svg { width: 22px; height: 22px; }
.nav-item span { font-size: 10px; font-weight: 600; letter-spacing: 0.3px; }

/* ================================ */
/* SCAN SCREEN                      */
/* ================================ */
.scan-screen { display:flex; flex-direction:column; }

.scan-header {
  padding: 20px 24px 0;
  text-align: center;
}
.scan-logo {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  margin-bottom: 4px;
}
.scan-logo h1 {
  font-family: 'Playfair Display', serif;
  font-size: 20px;
  font-weight: 700;
  color: var(--dark);
  letter-spacing: -0.3px;
}
.scan-subtitle {
  font-size: 13px;
  color: var(--text-muted);
  margin-top: 2px;
}

/* Camera Viewport */
.camera-viewport {
  margin: 20px 24px;
  background: var(--dark);
  border-radius: 20px;
  height: 300px;
  position: relative;
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
}
.camera-viewport::before {
  content: '';
  position: absolute;
  inset: 0;
  background:
    radial-gradient(circle at center, transparent 40%, rgba(27,40,56,0.6) 100%);
  z-index: 1;
}

/* Scan Frame Corners */
.scan-frame {
  position: absolute;
  inset: 30px;
  z-index: 2;
}
.scan-frame::before, .scan-frame::after,
.scan-frame-inner::before, .scan-frame-inner::after {
  content: '';
  position: absolute;
  width: 24px;
  height: 24px;
  border-color: var(--primary);
  border-style: solid;
  border-width: 0;
}
.scan-frame::before {
  top:0;left:0;
  border-top-width: 3px; border-left-width: 3px;
  border-radius: 6px 0 0 0;
}
.scan-frame::after {
  top:0;right:0;
  border-top-width: 3px; border-right-width: 3px;
  border-radius: 0 6px 0 0;
}
.scan-frame-inner::before {
  bottom:0;left:0;
  border-bottom-width: 3px; border-left-width: 3px;
  border-radius: 0 0 0 6px;
}
.scan-frame-inner::after {
  bottom:0;right:0;
  border-bottom-width: 3px; border-right-width: 3px;
  border-radius: 0 0 6px 0;
}

/* Scanning Line */
.scan-line {
  position: absolute;
  left: 30px;
  right: 30px;
  height: 2px;
  background: linear-gradient(90deg, transparent, var(--primary), transparent);
  z-index: 3;
  animation: scanLine 2.5s ease-in-out infinite;
  opacity: 0.8;
}
@keyframes scanLine {
  0%,100% { top: 30px; opacity: 0.3; }
  50% { top: calc(100% - 32px); opacity: 0.8; }
}

.camera-icon {
  color: rgba(255,255,255,0.2);
  z-index: 0;
}
.camera-icon svg { width: 64px; height: 64px; }

/* Scan Buttons */
.scan-actions {
  padding: 0 24px;
  display: flex;
  flex-direction: column;
  gap: 10px;
}
.btn-scan {
  width: 100%;
  padding: 16px;
  border: none;
  border-radius: var(--radius);
  font-family: inherit;
  font-size: 15px;
  font-weight: 700;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  transition: all 0.2s;
  -webkit-tap-highlight-color: transparent;
}
.btn-scan svg { width: 20px; height: 20px; }
.btn-scan-primary {
  background: var(--dark);
  color: white;
}
.btn-scan-primary:active { background: var(--dark-soft); transform: scale(0.98); }
.btn-scan-secondary {
  background: transparent;
  color: var(--dark);
  border: 1.5px solid var(--border);
}
.btn-scan-secondary:active { background: var(--primary-glow); border-color: var(--primary); }

/* Recent Scans */
.recent-section {
  padding: 20px 24px;
}
.recent-title {
  font-size: 11px;
  font-weight: 700;
  letter-spacing: 1.2px;
  text-transform: uppercase;
  color: var(--text-muted);
  margin-bottom: 12px;
}
.recent-items { display:flex; gap:10px; overflow-x:auto; padding-bottom:4px; }
.recent-item {
  flex-shrink: 0;
  width: 100px;
  background: var(--warm-white);
  border-radius: var(--radius-sm);
  padding: 10px;
  border: 1px solid var(--border);
  cursor: pointer;
  transition: border-color 0.2s;
}
.recent-item:hover { border-color: var(--primary-light); }
.recent-item:active { border-color: var(--primary); }
.recent-item-emoji { margin-bottom: 4px; width: 26px; height: 26px; }
.recent-item-emoji img { width: 100%; height: 100%; object-fit: contain; }
.recent-item-label { font-size: 10px; font-weight: 600; color: var(--dark); line-height: 1.3; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
.recent-item-tier {
  font-size: 9px;
  font-weight: 800;
  letter-spacing: 0.5px;
  margin-top: 4px;
  padding: 2px 6px;
  border-radius: 4px;
  display: inline-block;
}

/* ================================ */
/* ANALYZING SCREEN                 */
/* ================================ */
.analyzing-screen {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  background: var(--dark);
}
.analyzing-ring {
  width: 120px;
  height: 120px;
  border-radius: 50%;
  border: 3px solid rgba(200,149,108,0.15);
  border-top-color: var(--primary);
  animation: spin 1s linear infinite;
  margin-bottom: 32px;
  position: relative;
}
.analyzing-ring::after {
  content: '';
  position: absolute;
  inset: 8px;
  border-radius: 50%;
  border: 2px solid rgba(200,149,108,0.08);
  border-bottom-color: var(--primary-light);
  animation: spin 1.5s linear reverse infinite;
}
@keyframes spin { to { transform: rotate(360deg); } }
.analyzing-text {
  color: white;
  font-size: 17px;
  font-weight: 600;
}
.analyzing-sub {
  color: rgba(255,255,255,0.4);
  font-size: 13px;
  margin-top: 8px;
}
.analyzing-dots::after {
  content: '';
  animation: dots 1.5s steps(4) infinite;
}
@keyframes dots {
  0% { content: ''; }
  25% { content: '.'; }
  50% { content: '..'; }
  75% { content: '...'; }
}

/* ================================ */
/* RESULT SCREEN                    */
/* ================================ */
.result-screen { padding: 0; }

.result-hero {
  padding: 48px 24px 20px;
  text-align: center;
  position: relative;
}
.result-back {
  position: absolute;
  top: 14px; left: 16px;
  background: var(--cream);
  border: 1px solid var(--border);
  border-radius: 50%;
  width: 36px;
  height: 36px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--dark);
  cursor: pointer;
  padding: 0;
  font-family: inherit;
  transition: background 0.2s;
}
.result-back:active { background: var(--border); }
.result-back svg { width: 20px; height: 20px; }
.result-detected-label {
  font-size: 11px;
  font-weight: 700;
  letter-spacing: 1px;
  text-transform: uppercase;
  color: var(--text-muted);
  margin-bottom: 4px;
}
.result-product-name {
  font-family: 'Playfair Display', serif;
  font-size: 22px;
  font-weight: 700;
  color: var(--dark);
  line-height: 1.2;
  margin-bottom: 6px;
}
.result-animal {
  font-size: 14px;
  color: var(--text-muted);
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
}
.result-animal-icon { width: 20px; height: 20px; display: inline-flex; vertical-align: middle; }
.result-animal-icon img { width: 100%; height: 100%; object-fit: contain; }

/* Score Ring */
.score-ring-container {
  display: flex;
  justify-content: center;
  padding: 16px 0 8px;
}
.score-ring {
  width: 160px;
  height: 160px;
  position: relative;
}
.score-ring svg {
  width: 100%;
  height: 100%;
  transform: rotate(-90deg);
}
.score-ring-bg {
  fill: none;
  stroke: var(--border);
  stroke-width: 6;
}
.score-ring-fill {
  fill: none;
  stroke-width: 6;
  stroke-linecap: round;
  transition: stroke-dashoffset 1s ease-out;
}
.score-ring-center {
  position: absolute;
  inset: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}
.score-tier-label {
  font-size: 22px;
  font-weight: 800;
  letter-spacing: 0.5px;
}
.score-tier-sub {
  font-size: 11px;
  color: var(--text-muted);
  font-weight: 600;
}

/* Steps Bar */
.steps-section {
  padding: 0 24px 16px;
}
.steps-header {
  display: flex;
  justify-content: space-between;
  align-items: baseline;
  margin-bottom: 8px;
}
.steps-label {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-muted);
}
.steps-value {
  font-size: 13px;
  font-weight: 700;
  color: var(--dark);
}
.steps-track {
  height: 6px;
  background: var(--border);
  border-radius: 3px;
  overflow: hidden;
}
.steps-fill {
  height: 100%;
  border-radius: 3px;
  transition: width 1s ease-out;
}

/* Tier Explanation */
.tier-explain {
  margin: 0 24px;
  padding: 16px;
  border-radius: var(--radius);
  border: 1px solid;
  margin-bottom: 16px;
}
.tier-explain-title {
  font-size: 13px;
  font-weight: 700;
  margin-bottom: 4px;
}
.tier-explain-text {
  font-size: 12px;
  line-height: 1.5;
  opacity: 0.8;
}

/* Result Actions */
.result-actions {
  padding: 0 24px 24px;
  display: flex;
  flex-direction: column;
  gap: 10px;
}
.result-link {
  display: block;
  text-align: center;
  color: var(--primary);
  font-size: 13px;
  font-weight: 600;
  text-decoration: none;
  padding: 10px;
}
.result-link:hover { text-decoration: underline; }
.btn-new-scan {
  width: 100%;
  padding: 16px;
  background: var(--dark);
  color: white;
  border: none;
  border-radius: var(--radius);
  font-family: inherit;
  font-size: 15px;
  font-weight: 700;
  cursor: pointer;
  transition: all 0.2s;
}
.btn-new-scan:active { background: var(--dark-soft); transform: scale(0.98); }

/* ================================ */
/* DATABASE SCREEN                  */
/* ================================ */
.db-screen { padding: 0; }

.db-header {
  padding: 20px 24px 0;
}
.db-title {
  font-family: 'Playfair Display', serif;
  font-size: 24px;
  font-weight: 700;
  color: var(--dark);
  margin-bottom: 4px;
}
.db-count {
  font-size: 13px;
  color: var(--text-muted);
  margin-bottom: 16px;
}

/* Search */
.db-search {
  margin: 0 24px 12px;
  position: relative;
}
.db-search input {
  width: 100%;
  padding: 12px 16px 12px 40px;
  border: 1.5px solid var(--border);
  border-radius: var(--radius);
  font-family: inherit;
  font-size: 14px;
  background: var(--warm-white);
  color: var(--dark);
  outline: none;
  transition: border-color 0.2s;
}
.db-search input:focus { border-color: var(--primary); }
.db-search input::placeholder { color: var(--text-muted); }
.db-search svg {
  position: absolute;
  left: 14px;
  top: 50%;
  transform: translateY(-50%);
  width: 16px;
  height: 16px;
  color: var(--text-muted);
}

/* Filter Tabs */
.filter-tabs {
  display: flex;
  gap: 6px;
  padding: 0 24px 14px;
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
}
.filter-tabs::-webkit-scrollbar { display: none; }
.filter-tab {
  flex-shrink: 0;
  padding: 7px 14px;
  border-radius: 20px;
  border: 1.5px solid var(--border);
  background: transparent;
  font-family: inherit;
  font-size: 12px;
  font-weight: 600;
  color: var(--text-muted);
  cursor: pointer;
  transition: all 0.2s;
  -webkit-tap-highlight-color: transparent;
}
.filter-tab.active {
  background: var(--dark);
  color: white;
  border-color: var(--dark);
}
.filter-tab:hover { border-color: var(--dark-soft); color: var(--dark); }
.filter-tab:active { transform: scale(0.96); }

/* DB List */
.db-list {
  padding: 0 24px 24px;
}
.db-card {
  display: flex;
  align-items: center;
  gap: 14px;
  padding: 14px;
  background: var(--warm-white);
  border-radius: var(--radius);
  border: 1px solid var(--border);
  margin-bottom: 8px;
  cursor: pointer;
  transition: all 0.2s;
}
.db-card:hover {
  border-color: var(--primary-light);
}
.db-card:active {
  border-color: var(--primary);
  background: var(--primary-glow);
}
.db-card-emoji {
  width: 40px;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 10px;
  background: var(--cream);
  flex-shrink: 0;
  padding: 6px;
}
.db-card-emoji img { width: 100%; height: 100%; object-fit: contain; }
.db-card-info { flex: 1; min-width: 0; }
.db-card-label {
  font-size: 13px;
  font-weight: 700;
  color: var(--dark);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.db-card-product {
  font-size: 11px;
  color: var(--text-muted);
  margin-top: 1px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.db-card-right {
  text-align: right;
  flex-shrink: 0;
}
.db-card-tier {
  font-size: 10px;
  font-weight: 800;
  letter-spacing: 0.5px;
  padding: 3px 8px;
  border-radius: 5px;
  display: inline-block;
}
.db-card-steps {
  font-size: 10px;
  color: var(--text-muted);
  margin-top: 3px;
}

.db-empty {
  text-align: center;
  padding: 40px 0;
  color: var(--text-muted);
  font-size: 14px;
}

/* Tier Colors */
.tier-top { color: var(--tier-top); }
.tier-top-bg { background: var(--tier-top-bg); color: var(--tier-top); }
.tier-ok { color: var(--tier-ok); }
.tier-ok-bg { background: var(--tier-ok-bg); color: var(--tier-ok); }
.tier-uncool { color: var(--tier-uncool); }
.tier-uncool-bg { background: var(--tier-uncool-bg); color: var(--tier-uncool); }
.tier-nogo { color: var(--tier-nogo); }
.tier-nogo-bg { background: var(--tier-nogo-bg); color: var(--tier-nogo); }

.tier-explain.tier-top-border { border-color: var(--tier-top-bg); background: var(--tier-top-bg); }
.tier-explain.tier-ok-border { border-color: var(--tier-ok-bg); background: var(--tier-ok-bg); }
.tier-explain.tier-uncool-border { border-color: var(--tier-uncool-bg); background: var(--tier-uncool-bg); }
.tier-explain.tier-nogo-border { border-color: var(--tier-nogo-bg); background: var(--tier-nogo-bg); }

/* ================================ */
/* INFO SCREEN                      */
/* ================================ */
.info-screen { padding: 20px 24px; }

.info-title {
  font-family: 'Playfair Display', serif;
  font-size: 24px;
  font-weight: 700;
  color: var(--dark);
  margin-bottom: 16px;
}
.info-text {
  font-size: 14px;
  line-height: 1.7;
  color: var(--text-muted);
  margin-bottom: 24px;
}

.tier-legend {
  display: flex;
  flex-direction: column;
  gap: 10px;
  margin-bottom: 24px;
}
.tier-legend-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 14px;
  background: var(--warm-white);
  border-radius: var(--radius-sm);
  border: 1px solid var(--border);
}
.tier-legend-badge {
  font-size: 10px;
  font-weight: 800;
  letter-spacing: 0.3px;
  padding: 5px 8px;
  border-radius: 5px;
  min-width: 72px;
  text-align: center;
  white-space: nowrap;
  flex-shrink: 0;
}
.tier-legend-desc {
  font-size: 13px;
  color: var(--dark);
  line-height: 1.4;
}

.info-section {
  margin-bottom: 24px;
}
.info-section h3 {
  font-size: 14px;
  font-weight: 700;
  margin-bottom: 8px;
  color: var(--dark);
}
.info-section p {
  font-size: 13px;
  color: var(--text-muted);
  line-height: 1.6;
}

.info-credit {
  padding: 16px;
  background: var(--primary-glow);
  border-radius: var(--radius);
  text-align: center;
  border: 1px solid var(--primary-light);
}
.info-credit p {
  font-size: 12px;
  color: var(--text-muted);
  line-height: 1.5;
}
.info-credit a {
  color: var(--primary);
  font-weight: 600;
  text-decoration: none;
}

/* Hidden file input */
.hidden-input { display: none; }

/* Scroll styling */
.screen::-webkit-scrollbar { width: 0; }
</style>
</head>
<body>

<div class="phone-frame">

  <!-- Status Bar -->
  <div class="status-bar">
    <span>9:41</span>
    <div class="status-bar-right">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 9l4-4 4 4"/><path d="M5 5v14"/><path d="M10 18h4"/><path d="M10 14h7"/><path d="M10 10h10"/></svg>
      <svg viewBox="0 0 24 24" fill="currentColor"><rect x="1" y="6" width="4" height="12" rx="1" opacity=".3"/><rect x="7" y="4" width="4" height="14" rx="1" opacity=".5"/><rect x="13" y="2" width="4" height="16" rx="1" opacity=".7"/><rect x="19" y="0" width="4" height="18" rx="1"/></svg>
      <svg viewBox="0 0 28 14" fill="currentColor"><rect x="0" y="1" width="23" height="12" rx="3" fill="none" stroke="currentColor" stroke-width="1.5"/><rect x="24.5" y="4.5" width="2" height="5" rx="1"/><rect x="2" y="3" width="17" height="8" rx="1.5"/></svg>
    </div>
  </div>

  <!-- Screens -->
  <div class="screens">

    <!-- SCAN SCREEN -->
    <div class="screen scan-screen active" id="screen-scan">
      <div class="scan-header">
        <div class="scan-logo">
          <h1>Essen mit Herz</h1>
        </div>
        <p class="scan-subtitle">Tierwohl-Check beim Einkaufen</p>
      </div>

      <div class="camera-viewport">
        <div class="scan-frame"><div class="scan-frame-inner"></div></div>
        <div class="scan-line"></div>
        <div class="camera-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M23 19a2 2 0 01-2 2H3a2 2 0 01-2-2V8a2 2 0 012-2h4l2-3h6l2 3h4a2 2 0 012 2z"/><circle cx="12" cy="13" r="4"/></svg>
        </div>
      </div>

      <div class="scan-actions">
        <button class="btn-scan btn-scan-primary" onclick="startScan()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M23 19a2 2 0 01-2 2H3a2 2 0 01-2-2V8a2 2 0 012-2h4l2-3h6l2 3h4a2 2 0 012 2z"/><circle cx="12" cy="13" r="4"/></svg>
          Foto aufnehmen
        </button>
        <button class="btn-scan btn-scan-secondary" onclick="document.getElementById('gallery-input').click()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><path d="M21 15l-5-5L5 21"/></svg>
          Aus Galerie
        </button>
        <input type="file" accept="image/*" class="hidden-input" id="gallery-input" onchange="startScan()">
      </div>

      <div class="recent-section" id="recent-section" style="display:none">
        <div class="recent-title">Letzte Scans</div>
        <div class="recent-items" id="recent-items"></div>
      </div>
    </div>

    <!-- ANALYZING SCREEN -->
    <div class="screen analyzing-screen" id="screen-analyzing">
      <div class="analyzing-ring"></div>
      <div class="analyzing-text">Analysiere Produkt<span class="analyzing-dots"></span></div>
      <div class="analyzing-sub">Label & Tierart werden erkannt</div>
    </div>

    <!-- RESULT SCREEN -->
    <div class="screen result-screen" id="screen-result">
      <div class="result-hero">
        <button class="result-back" onclick="showScreen('scan')">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
        </button>
        <div class="result-detected-label" id="result-label"></div>
        <div class="result-product-name" id="result-product"></div>
        <div class="result-animal" id="result-animal"></div>
      </div>

      <div class="score-ring-container">
        <div class="score-ring">
          <svg viewBox="0 0 120 120">
            <circle class="score-ring-bg" cx="60" cy="60" r="52"/>
            <circle class="score-ring-fill" id="score-ring-fill" cx="60" cy="60" r="52"
              stroke-dasharray="326.73" stroke-dashoffset="326.73"/>
          </svg>
          <div class="score-ring-center">
            <div class="score-tier-label" id="score-tier"></div>
            <div class="score-tier-sub">Tierwohl</div>
          </div>
        </div>
      </div>

      <div class="steps-section">
        <div class="steps-header">
          <span class="steps-label">Tierwohl-Score</span>
          <span class="steps-value" id="steps-value"></span>
        </div>
        <div class="steps-track">
          <div class="steps-fill" id="steps-fill" style="width:0%"></div>
        </div>
      </div>

      <div class="tier-explain" id="tier-explain">
        <div class="tier-explain-title" id="tier-explain-title"></div>
        <div class="tier-explain-text" id="tier-explain-text"></div>
      </div>

      <div class="result-actions">
        <a class="result-link" id="result-link" href="#" target="_blank">Mehr erfahren auf essenmitherz.ch &rarr;</a>
        <button class="btn-new-scan" onclick="showScreen('scan')">Neuen Scan starten</button>
      </div>
    </div>

    <!-- DATABASE SCREEN -->
    <div class="screen db-screen" id="screen-db">
      <div class="db-header">
        <div class="db-title">Datenbank</div>
        <div class="db-count" id="db-count"></div>
      </div>

      <div class="db-search">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/></svg>
        <input type="text" placeholder="Label suchen..." id="db-search-input" oninput="filterDB()">
      </div>

      <div class="filter-tabs" id="filter-tabs">
        <button class="filter-tab active" data-filter="alle" onclick="setFilter(this)">Alle</button>
        <button class="filter-tab" data-filter="rindfleisch" onclick="setFilter(this)">Rind</button>
        <button class="filter-tab" data-filter="kalbfleisch" onclick="setFilter(this)">Kalb</button>
        <button class="filter-tab" data-filter="schweinefleisch" onclick="setFilter(this)">Schwein</button>
        <button class="filter-tab" data-filter="poulet" onclick="setFilter(this)">Poulet</button>
        <button class="filter-tab" data-filter="eier" onclick="setFilter(this)">Eier</button>
        <button class="filter-tab" data-filter="milch" onclick="setFilter(this)">Milch</button>
      </div>

      <div class="db-list" id="db-list"></div>
    </div>

    <!-- INFO SCREEN -->
    <div class="screen info-screen" id="screen-info">
      <div class="info-title">Was ist das?</div>
      <p class="info-text">
        Der <strong>Essen mit Herz Scanner</strong> hilft dir, beim Einkaufen
        schnell die Tierwohl-Bewertung von Schweizer Fleisch- und Milchprodukten
        zu erfahren. Einfach Produkt fotografieren, fertig.
      </p>

      <div class="info-section">
        <h3>Bewertungsstufen</h3>
      </div>

      <div class="tier-legend">
        <div class="tier-legend-item">
          <span class="tier-legend-badge tier-top-bg">TOP</span>
          <span class="tier-legend-desc">Bevorzugen. Sehr gute Vorgaben.</span>
        </div>
        <div class="tier-legend-item">
          <span class="tier-legend-badge tier-ok-bg">OK</span>
          <span class="tier-legend-desc">Empfehlenswert. Gute Vorgaben, man darf zugreifen.</span>
        </div>
        <div class="tier-legend-item">
          <span class="tier-legend-badge tier-uncool-bg">UNCOOL</span>
          <span class="tier-legend-desc">Wenn's sein muss. Ungen&uuml;gende Vorgaben.</span>
        </div>
        <div class="tier-legend-item">
          <span class="tier-legend-badge tier-nogo-bg">NO GO</span>
          <span class="tier-legend-desc">Finger weg. Schlechte bis gar keine Vorgaben.</span>
        </div>
      </div>

      <div class="info-section">
        <h3>So funktionierts</h3>
        <p>
          1. Produktverpackung fotografieren<br>
          2. KI erkennt Label und Tierart<br>
          3. Bewertung aus der Datenbank von essenmitherz.ch anzeigen
        </p>
      </div>

      <div class="info-section">
        <h3>Tierwohl-Score</h3>
        <p>
          Der Score zeigt, wie nah ein Label am bestm&ouml;glichen
          Tierwohl-Standard ist. Je h&ouml;her, desto besser.
        </p>
      </div>

      <div class="info-credit">
        <p>
          Daten von <a href="https://essenmitherz.ch" target="_blank">essenmitherz.ch</a><br>
          <span style="font-size:11px; opacity:0.7">Ein Projekt des Schweizer Tierschutz STS</span>
        </p>
      </div>
    </div>

  </div>

  <!-- Bottom Navigation -->
  <div class="bottom-nav">
    <button class="nav-item active" data-screen="scan" onclick="navTo(this)">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M23 19a2 2 0 01-2 2H3a2 2 0 01-2-2V8a2 2 0 012-2h4l2-3h6l2 3h4a2 2 0 012 2z"/><circle cx="12" cy="13" r="4"/></svg>
      <span>Scan</span>
    </button>
    <button class="nav-item" data-screen="db" onclick="navTo(this)">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/></svg>
      <span>Datenbank</span>
    </button>
    <button class="nav-item" data-screen="info" onclick="navTo(this)">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><circle cx="12" cy="12" r="9"/><path d="M12 7.5v0" stroke-linecap="round" stroke-width="2.5"/><path d="M12 11v5.5" stroke-linecap="round"/></svg>
      <span>Info</span>
    </button>
  </div>

</div>

<script>
// Embedded scraped data
const DB = [{"label":"AGRI NATURA D","label_url":"https://essenmitherz.ch/label-agri-natura-2/","animal":"schweinefleisch","product_title":"Schweinefleisch Agri Natura","product_url":"https://essenmitherz.ch/schweinefleisch-agri-natura/","tier":"OK","steps_to_go":21},{"label":"AGRI NATURA D","label_url":"https://essenmitherz.ch/label-agri-natura-2/","animal":"kalbfleisch","product_title":"Kalbfleisch Agri Natura","product_url":"https://essenmitherz.ch/kalbfleisch-agri-natura/","tier":"OK","steps_to_go":23},{"label":"AGRI NATURA D","label_url":"https://essenmitherz.ch/label-agri-natura-2/","animal":"rindfleisch","product_title":"Rindfleisch Agri Natura","product_url":"https://essenmitherz.ch/rindfleisch-agri-natura/","tier":"OK","steps_to_go":23},{"label":"AGRI NATURA D","label_url":"https://essenmitherz.ch/label-agri-natura-2/","animal":"eier","product_title":"Eier Agri Natura","product_url":"https://essenmitherz.ch/eier-ip-suisse-2/","tier":"OK","steps_to_go":20},{"label":"Pro Montagna D","label_url":"https://essenmitherz.ch/label-agri-natura/","animal":"milch","product_title":"Milch Pro Montagna","product_url":"https://essenmitherz.ch/milch-pro-montagna/","tier":"UNCOOL","steps_to_go":36},{"label":"Fairmilk Aldi  D","label_url":"https://essenmitherz.ch/label-aldi-faire-milch-d/","animal":null,"product_title":"Fairmilk Aldi","product_url":"https://essenmitherz.ch/aldi-faire-milch/","tier":"OK","steps_to_go":19},{"label":"BIO NATUR PLUS D","label_url":"https://essenmitherz.ch/label-bio-natur-plus/","animal":"schweinefleisch","product_title":"Schweinefleisch Bio natur plus","product_url":"https://essenmitherz.ch/schweinefleisch-manor-bio-natur-plus/","tier":"OK","steps_to_go":17},{"label":"BIO NATUR PLUS D","label_url":"https://essenmitherz.ch/label-bio-natur-plus/","animal":"kalbfleisch","product_title":"Kalbfleisch Bio natur plus","product_url":"https://essenmitherz.ch/kalbfleisch-manor-bio-natur-plus/","tier":"OK","steps_to_go":23},{"label":"BIO NATUR PLUS D","label_url":"https://essenmitherz.ch/label-bio-natur-plus/","animal":"rindfleisch","product_title":"Rindfleisch Bio natur plus","product_url":"https://essenmitherz.ch/rindfleisch-manor-bio-natur-plus/","tier":"OK","steps_to_go":16},{"label":"BIO NATUR PLUS D","label_url":"https://essenmitherz.ch/label-bio-natur-plus/","animal":"poulet","product_title":"Pouletfleisch Bio natur plus","product_url":"https://essenmitherz.ch/pouletfleisch-bio-natur-plus/","tier":"TOP","steps_to_go":8},{"label":"BIO NATUR PLUS D","label_url":"https://essenmitherz.ch/label-bio-natur-plus/","animal":"eier","product_title":"Eier bio natur plus","product_url":"https://essenmitherz.ch/eier-bio-natur-plus/","tier":"TOP","steps_to_go":12},{"label":"BIO ORGANIC MIT SCHWEIZER KREUZ D","label_url":"https://essenmitherz.ch/label-bio-organic/","animal":"schweinefleisch","product_title":"Schweinefleisch Bio Organic (CH)","product_url":"https://essenmitherz.ch/schweinefleisch-lidl-bio/","tier":"OK","steps_to_go":17},{"label":"BIO ORGANIC MIT SCHWEIZER KREUZ D","label_url":"https://essenmitherz.ch/label-bio-organic/","animal":"rindfleisch","product_title":"Rindfleisch Bio Organic (CH)","product_url":"https://essenmitherz.ch/rindfleisch-bio-organic/","tier":"OK","steps_to_go":17},{"label":"BIO ORGANIC MIT SCHWEIZER KREUZ D","label_url":"https://essenmitherz.ch/label-bio-organic/","animal":"poulet","product_title":"Pouletfleisch Bio Organic (CH)","product_url":"https://essenmitherz.ch/pouletfleisch-bio-organic/","tier":"TOP","steps_to_go":8},{"label":"BIO ORGANIC MIT SCHWEIZER KREUZ D","label_url":"https://essenmitherz.ch/label-bio-organic/","animal":"eier","product_title":"Eier Lidl Bio organic (CH)","product_url":"https://essenmitherz.ch/eier-lidl-bio-organic/","tier":"TOP","steps_to_go":12},{"label":"BIO ORGANIC MIT SCHWEIZER KREUZ D","label_url":"https://essenmitherz.ch/label-bio-organic/","animal":"milch","product_title":"Milch Bio Organic","product_url":"https://essenmitherz.ch/milch-bio-organic/","tier":"OK","steps_to_go":17},{"label":"BIO SUISSE / BIO KNOSPE D","label_url":"https://essenmitherz.ch/label-bio-suisse-bio-knospe/","animal":"poulet","product_title":"Pouletfleisch Bio Knospe","product_url":"https://essenmitherz.ch/pouletfleisch-bio-knospe/","tier":"TOP","steps_to_go":8},{"label":"BIO SUISSE / BIO KNOSPE D","label_url":"https://essenmitherz.ch/label-bio-suisse-bio-knospe/","animal":"rindfleisch","product_title":"Rindfleisch Natura-Beef Bio","product_url":"https://essenmitherz.ch/rindfleisch-natura-beef-bio/","tier":"TOP","steps_to_go":8},{"label":"BIO SUISSE / BIO KNOSPE D","label_url":"https://essenmitherz.ch/label-bio-suisse-bio-knospe/","animal":"kalbfleisch","product_title":"Kalbfleisch Bio Knospe","product_url":"https://essenmitherz.ch/kalbfleisch-bio-knospe/","tier":"OK","steps_to_go":23},{"label":"BIO SUISSE / BIO KNOSPE D","label_url":"https://essenmitherz.ch/label-bio-suisse-bio-knospe/","animal":"rindfleisch","product_title":"Rindfleisch Bio Knospe","product_url":"https://essenmitherz.ch/rindfleisch-bio-suisse-2/","tier":"OK","steps_to_go":17},{"label":"BIO SUISSE / BIO KNOSPE D","label_url":"https://essenmitherz.ch/label-bio-suisse-bio-knospe/","animal":"kalbfleisch","product_title":"Kalbfleisch Natura-Veal Bio","product_url":"https://essenmitherz.ch/kalbfleisch-natura-veal-bio/","tier":"TOP","steps_to_go":9},{"label":"BIO SUISSE / BIO KNOSPE D","label_url":"https://essenmitherz.ch/label-bio-suisse-bio-knospe/","animal":"eier","product_title":"Eier Bio Suisse","product_url":"https://essenmitherz.ch/eier-bio-suisse/","tier":"TOP","steps_to_go":12},{"label":"BIO SUISSE / BIO KNOSPE D","label_url":"https://essenmitherz.ch/label-bio-suisse-bio-knospe/","animal":"milch","product_title":"Milch Bio Suisse","product_url":"https://essenmitherz.ch/milch-bio-knospe/","tier":"OK","steps_to_go":17},{"label":"BÜNDNER PUURACHALB D","label_url":"https://essenmitherz.ch/label-buendner-puurachalb-2/","animal":"kalbfleisch","product_title":"Kalbfleisch Bündner Puurachalb","product_url":"https://essenmitherz.ch/kalbfleisch-buendner-puurachalb/","tier":"OK","steps_to_go":23},{"label":"Coop Milchprogramm D","label_url":"https://essenmitherz.ch/label-coop-milchprogramm-d/","animal":null,"product_title":"Coop Milch-Programm","product_url":"https://essenmitherz.ch/coop-milch-programm/","tier":"OK","steps_to_go":24},{"label":"COOP NATURAFARM D","label_url":"https://essenmitherz.ch/label-coop-naturafarm/","animal":"poulet","product_title":"Pouletfleisch Coop Naturafarm","product_url":"https://essenmitherz.ch/pouletfleisch-coop-naturafarm/","tier":"TOP","steps_to_go":4},{"label":"COOP NATURAFARM D","label_url":"https://essenmitherz.ch/label-coop-naturafarm/","animal":"eier","product_title":"Eier Coop Naturafarm","product_url":"https://essenmitherz.ch/eier-coop-naturafarm/","tier":"TOP","steps_to_go":13},{"label":"Cowpassion D","label_url":"https://essenmitherz.ch/label-cowpassion-d/","animal":"milch","product_title":"Milch Cowpassion MuKa","product_url":"https://essenmitherz.ch/milch-cowpassion-muka/","tier":"TOP","steps_to_go":12},{"label":"DEMETER D","label_url":"https://essenmitherz.ch/label-demeter-2/","animal":"rindfleisch","product_title":"Rindfleisch Demeter","product_url":"https://essenmitherz.ch/rindfleisch-demeter/","tier":"OK","steps_to_go":16},{"label":"DEMETER D","label_url":"https://essenmitherz.ch/label-demeter-2/","animal":"kalbfleisch","product_title":"Kalbfleisch Demeter","product_url":"https://essenmitherz.ch/kalbfleisch-demeter/","tier":"OK","steps_to_go":23},{"label":"DEMETER D","label_url":"https://essenmitherz.ch/label-demeter-2/","animal":"poulet","product_title":"Pouletfleisch Demeter","product_url":"https://essenmitherz.ch/pouletfleisch-demeter/","tier":"TOP","steps_to_go":6},{"label":"DEMETER D","label_url":"https://essenmitherz.ch/label-demeter-2/","animal":"schweinefleisch","product_title":"Schweinefleisch Demeter","product_url":"https://essenmitherz.ch/schweinefleisch-demeter/","tier":"OK","steps_to_go":17},{"label":"DEMETER D","label_url":"https://essenmitherz.ch/label-demeter-2/","animal":"eier","product_title":"Eier Demeter Hahn im Glück","product_url":"https://essenmitherz.ch/eier-demeter/","tier":"TOP","steps_to_go":10},{"label":"DEMETER D","label_url":"https://essenmitherz.ch/label-demeter-2/","animal":"eier","product_title":"Eier Alnatura Demeter","product_url":"https://essenmitherz.ch/eier-alnatura-demeter/","tier":"TOP","steps_to_go":10},{"label":"DEMETER D","label_url":"https://essenmitherz.ch/label-demeter-2/","animal":"eier","product_title":"Eier Alnatura Demeter Mobilstall","product_url":"https://essenmitherz.ch/eier-alnatura-demeter-2/","tier":"TOP","steps_to_go":10},{"label":"DEMETER D","label_url":"https://essenmitherz.ch/label-demeter-2/","animal":"milch","product_title":"Milch Demeter","product_url":"https://essenmitherz.ch/milch-demeter/","tier":"OK","steps_to_go":16},{"label":"Die Faire Milch","label_url":"https://essenmitherz.ch/label-die-faire-milch-faireswiss-d/","animal":null,"product_title":"Die Faire Milch / Faireswiss","product_url":"https://essenmitherz.ch/di-faire-milch/","tier":"UNCOOL","steps_to_go":26},{"label":"Heidimilch D","label_url":"https://essenmitherz.ch/label-heidimilch-d/","animal":"milch","product_title":"Heidi Milch","product_url":"https://essenmitherz.ch/milch-heidi/","tier":"UNCOOL","steps_to_go":36},{"label":"Heumilch D","label_url":"https://essenmitherz.ch/label-heumilch-d/","animal":"milch","product_title":"Heumilch Schweiz","product_url":"https://essenmitherz.ch/milch-raus-2/","tier":"OK","steps_to_go":22},{"label":"IP-SUISSE D","label_url":"https://essenmitherz.ch/label-ip-suisse-2/","animal":"schweinefleisch","product_title":"Schweinefleisch IP-SUISSE","product_url":"https://essenmitherz.ch/ip-suisse-fuer-schweinefleisch-3/","tier":"OK","steps_to_go":21},{"label":"IP-SUISSE D","label_url":"https://essenmitherz.ch/label-ip-suisse-2/","animal":"kalbfleisch","product_title":"Kalbfleisch IP-SUISSE","product_url":"https://essenmitherz.ch/kalbfleisch-ip-suisse/","tier":"OK","steps_to_go":23},{"label":"IP-SUISSE D","label_url":"https://essenmitherz.ch/label-ip-suisse-2/","animal":"poulet","product_title":"Pouletfleisch IP-SUISSE BTS und Weidegang","product_url":"https://essenmitherz.ch/pouletfleisch-ip-suisse-bts-und-weidegang/","tier":"OK","steps_to_go":20},{"label":"IP-SUISSE D","label_url":"https://essenmitherz.ch/label-ip-suisse-2/","animal":"rindfleisch","product_title":"Rindfleisch IP-SUISSE","product_url":"https://essenmitherz.ch/rindfleisch-ip-suisse/","tier":"OK","steps_to_go":22},{"label":"IP-SUISSE D","label_url":"https://essenmitherz.ch/label-ip-suisse-2/","animal":null,"product_title":"IP-SUISSE Wiesenmilch","product_url":"https://essenmitherz.ch/ip-suisse-wiesenmilch/","tier":"OK","steps_to_go":19},{"label":"IP-SUISSE D","label_url":"https://essenmitherz.ch/label-ip-suisse/","animal":"schweinefleisch","product_title":"Schweinefleisch IP-SUISSE","product_url":"https://essenmitherz.ch/ip-suisse-fuer-schweinefleisch-3/","tier":"OK","steps_to_go":21},{"label":"IP-SUISSE D","label_url":"https://essenmitherz.ch/label-ip-suisse/","animal":"kalbfleisch","product_title":"Kalbfleisch IP-SUISSE","product_url":"https://essenmitherz.ch/kalbfleisch-ip-suisse/","tier":"OK","steps_to_go":23},{"label":"IP-SUISSE D","label_url":"https://essenmitherz.ch/label-ip-suisse/","animal":"poulet","product_title":"Pouletfleisch IP-SUISSE BTS und Weidegang","product_url":"https://essenmitherz.ch/pouletfleisch-ip-suisse-bts-und-weidegang/","tier":"OK","steps_to_go":20},{"label":"IP-SUISSE D","label_url":"https://essenmitherz.ch/label-ip-suisse/","animal":"rindfleisch","product_title":"Rindfleisch IP-SUISSE","product_url":"https://essenmitherz.ch/rindfleisch-ip-suisse/","tier":"OK","steps_to_go":22},{"label":"IP-SUISSE D","label_url":"https://essenmitherz.ch/label-ip-suisse/","animal":null,"product_title":"IP-SUISSE Wiesenmilch","product_url":"https://essenmitherz.ch/ip-suisse-wiesenmilch/","tier":"OK","steps_to_go":19},{"label":"KAGfreiland D","label_url":"https://essenmitherz.ch/label-kag-freiland-2/","animal":"kalbfleisch","product_title":"Kalbfleisch KAGfreiland","product_url":"https://essenmitherz.ch/kalbfleisch-kag-freiland/","tier":"TOP","steps_to_go":10},{"label":"KAGfreiland D","label_url":"https://essenmitherz.ch/label-kag-freiland-2/","animal":"poulet","product_title":"Pouletfleisch KAGfreiland","product_url":"https://essenmitherz.ch/pouletfleisch-kag-freiland/","tier":"TOP","steps_to_go":5},{"label":"KAGfreiland D","label_url":"https://essenmitherz.ch/label-kag-freiland-2/","animal":"rindfleisch","product_title":"Rindfleisch KAGfreiland","product_url":"https://essenmitherz.ch/rindfleisch-kag-freiland/","tier":"TOP","steps_to_go":6},{"label":"KAGfreiland D","label_url":"https://essenmitherz.ch/label-kag-freiland-2/","animal":"eier","product_title":"Eier KAGfreiland","product_url":"https://essenmitherz.ch/eier-kag-freiland/","tier":"TOP","steps_to_go":9},{"label":"KAGfreiland D","label_url":"https://essenmitherz.ch/label-kag-freiland-2/","animal":"milch","product_title":"Milch KAG Freiland","product_url":"https://essenmitherz.ch/milch-kag-freiland/","tier":"TOP","steps_to_go":13},{"label":"KRÄUTERSCHWEIN D","label_url":"https://essenmitherz.ch/label-kraeuterschwein/","animal":"schweinefleisch","product_title":"Schweinefleisch Kräuterschwein","product_url":"https://essenmitherz.ch/schweinefleisch-kraeuterschwein/","tier":"OK","steps_to_go":21},{"label":"MIGROS BIO MIT SCHWEIZERKREUZ D","label_url":"https://essenmitherz.ch/label-migros-bio-mit-schweizerkreuz/","animal":"schweinefleisch","product_title":"Schweinefleisch Migros Bio (CH)","product_url":"https://essenmitherz.ch/schweinefleisch-migros-bio/","tier":"OK","steps_to_go":17},{"label":"MIGROS BIO MIT SCHWEIZERKREUZ D","label_url":"https://essenmitherz.ch/label-migros-bio-mit-schweizerkreuz/","animal":"rindfleisch","product_title":"Rindfleisch Migros Bio (CH)","product_url":"https://essenmitherz.ch/rindfleisch-migros-bio/","tier":"OK","steps_to_go":16},{"label":"MIGROS BIO MIT SCHWEIZERKREUZ D","label_url":"https://essenmitherz.ch/label-migros-bio-mit-schweizerkreuz/","animal":"poulet","product_title":"Pouletfleisch Migros Bio (CH)","product_url":"https://essenmitherz.ch/pouletfleisch-migros-bio/","tier":"TOP","steps_to_go":8},{"label":"MIGROS BIO MIT SCHWEIZERKREUZ D","label_url":"https://essenmitherz.ch/label-migros-bio-mit-schweizerkreuz/","animal":"eier","product_title":"Eier Migros Bio CH","product_url":"https://essenmitherz.ch/eier-migros-bio/","tier":"TOP","steps_to_go":12},{"label":"MIGROS BIO OHNE SCHWEIZERKREUZ D","label_url":"https://essenmitherz.ch/label-migros-bio-ohne-schweizerkreuz/","animal":"schweinefleisch","product_title":"Schweinefleisch Migros Bio (EU)","product_url":"https://essenmitherz.ch/schweinefleisch-migros-bio-2/","tier":"UNCOOL","steps_to_go":29},{"label":"MIGROS BIO WEIDE-BEEF D","label_url":"https://essenmitherz.ch/label-migros-bio-weide-beef/","animal":"rindfleisch","product_title":"Rindfleisch Migros Bio-Weide-Beef","product_url":"https://essenmitherz.ch/rindfleisch-bio-suisse/","tier":"TOP","steps_to_go":11},{"label":"Migros nachhaltige Milch D","label_url":"https://essenmitherz.ch/label-migros-nachhaltige-milch-d/","animal":null,"product_title":"Migros nachhaltige Milch","product_url":"https://essenmitherz.ch/migros-nachhaltige-milch/","tier":"UNCOOL","steps_to_go":26},{"label":"MIGROS WEIDE-BEEF D","label_url":"https://essenmitherz.ch/label-migros-weide-beef/","animal":"rindfleisch","product_title":"Rindfleisch Migros Weide-Beef","product_url":"https://essenmitherz.ch/rindfleisch-migros-weide-beef/","tier":"TOP","steps_to_go":13},{"label":"Milch Grüner Teppich D","label_url":"https://essenmitherz.ch/label-milch-gruener-teppich-d/","animal":"milch","product_title":"Milch Grüner Teppich","product_url":"https://essenmitherz.ch/milch-gruener-teppich/","tier":"UNCOOL","steps_to_go":28},{"label":"NATURA-BEEF D","label_url":"https://essenmitherz.ch/label-natura-beef/","animal":"rindfleisch","product_title":"Rindfleisch Natura-Beef Bio","product_url":"https://essenmitherz.ch/rindfleisch-natura-beef-bio/","tier":"TOP","steps_to_go":8},{"label":"NATURA-BEEF D","label_url":"https://essenmitherz.ch/label-natura-beef/","animal":"rindfleisch","product_title":"Rindfleisch Natura-Beef","product_url":"https://essenmitherz.ch/rindfleisch-natura-beef/","tier":"TOP","steps_to_go":8},{"label":"NATURA-VEAL DE","label_url":"https://essenmitherz.ch/label-natura-veal/","animal":"kalbfleisch","product_title":"Kalbfleisch Natura-Veal","product_url":"https://essenmitherz.ch/kalbfleisch-natura-veal/","tier":"TOP","steps_to_go":9},{"label":"NATURA-VEAL DE","label_url":"https://essenmitherz.ch/label-natura-veal/","animal":"kalbfleisch","product_title":"Kalbfleisch Natura-Veal Bio","product_url":"https://essenmitherz.ch/kalbfleisch-natura-veal-bio/","tier":"TOP","steps_to_go":9},{"label":"COOP NATURAPLAN D","label_url":"https://essenmitherz.ch/label-naturaplan/","animal":"kalbfleisch","product_title":"Kalbfleisch Coop Naturaplan","product_url":"https://essenmitherz.ch/kalbfleisch-naturaplan/","tier":"OK","steps_to_go":23},{"label":"COOP NATURAPLAN D","label_url":"https://essenmitherz.ch/label-naturaplan/","animal":"schweinefleisch","product_title":"Schweinefleisch Coop Naturaplan","product_url":"https://essenmitherz.ch/schweinefleisch-naturaplan/","tier":"OK","steps_to_go":17},{"label":"COOP NATURAPLAN D","label_url":"https://essenmitherz.ch/label-naturaplan/","animal":"rindfleisch","product_title":"Rindfleisch Coop Naturaplan","product_url":"https://essenmitherz.ch/rindfleisch-naturaplan/","tier":"OK","steps_to_go":16},{"label":"COOP NATURAPLAN D","label_url":"https://essenmitherz.ch/label-naturaplan/","animal":"poulet","product_title":"Pouletfleisch Coop Naturaplan","product_url":"https://essenmitherz.ch/pouletfleisch-naturaplan/","tier":"TOP","steps_to_go":8},{"label":"COOP NATURAPLAN D","label_url":"https://essenmitherz.ch/label-naturaplan/","animal":"eier","product_title":"Eier Coop Naturaplan","product_url":"https://essenmitherz.ch/eier-naturaplan/","tier":"TOP","steps_to_go":12},{"label":"COOP NATURAPLAN D","label_url":"https://essenmitherz.ch/label-naturaplan/","animal":"milch","product_title":"Milch Coop Naturaplan","product_url":"https://essenmitherz.ch/milch-coop-naturaplan/","tier":"OK","steps_to_go":17},{"label":"NATURE SUISSE BIO D","label_url":"https://essenmitherz.ch/label-nature-suisse-bio/","animal":"schweinefleisch","product_title":"Schweinefleisch Nature Suisse Bio","product_url":"https://essenmitherz.ch/schweinefleisch-aldi-nature-suisse-bio/","tier":"OK","steps_to_go":17},{"label":"NATURE SUISSE BIO D","label_url":"https://essenmitherz.ch/label-nature-suisse-bio/","animal":"kalbfleisch","product_title":"Kalbfleisch Nature Suisse Bio","product_url":"https://essenmitherz.ch/kalbfleisch-aldi-nature-suisse-bio-2/","tier":"OK","steps_to_go":23},{"label":"NATURE SUISSE BIO D","label_url":"https://essenmitherz.ch/label-nature-suisse-bio/","animal":"rindfleisch","product_title":"Rindfleisch Nature Suisse Bio","product_url":"https://essenmitherz.ch/rindfleisch-aldi-nature-suisse-bio/","tier":"OK","steps_to_go":17},{"label":"NATURE SUISSE BIO D","label_url":"https://essenmitherz.ch/label-nature-suisse-bio/","animal":"poulet","product_title":"Pouletfleisch Nature Suisse Bio","product_url":"https://essenmitherz.ch/pouletfleisch-nature-suisse-bio/","tier":"TOP","steps_to_go":8},{"label":"NATURE SUISSE BIO D","label_url":"https://essenmitherz.ch/label-nature-suisse-bio/","animal":"milch","product_title":"Milch Nature Suisse Bio","product_url":"https://essenmitherz.ch/milch-coop-naturaplan-2/","tier":"OK","steps_to_go":17},{"label":"NATURE SUISSE D","label_url":"https://essenmitherz.ch/label-nature-suisse/","animal":"schweinefleisch","product_title":"Schweinefleisch Nature Suisse","product_url":"https://essenmitherz.ch/schweinefleisch-aldi-nature-suisse/","tier":"OK","steps_to_go":21},{"label":"NATURE SUISSE D","label_url":"https://essenmitherz.ch/label-nature-suisse/","animal":"kalbfleisch","product_title":"Kalbfleisch Nature Suisse","product_url":"https://essenmitherz.ch/kalbfleisch-aldi-nature-suisse/","tier":"OK","steps_to_go":23},{"label":"NATURE SUISSE D","label_url":"https://essenmitherz.ch/label-nature-suisse/","animal":"rindfleisch","product_title":"Rindfleisch Nature Suisse","product_url":"https://essenmitherz.ch/rindfleisch-aldi-nature-suisse/","tier":"OK","steps_to_go":23},{"label":"NATURE SUISSE D","label_url":"https://essenmitherz.ch/label-nature-suisse/","animal":"eier","product_title":"Eier Nature Suisse","product_url":"https://essenmitherz.ch/eier-nature-suisse/","tier":"OK","steps_to_go":20},{"label":"OPTIGAL D","label_url":"https://essenmitherz.ch/label-optigal/","animal":"poulet","product_title":"Pouletfleisch Optigal","product_url":"https://essenmitherz.ch/pouletfleisch-optigal/","tier":"UNCOOL","steps_to_go":30},{"label":"Retour aux sources D","label_url":"https://essenmitherz.ch/label-retour-aux-sources-d/","animal":"rindfleisch","product_title":"Rindfleisch Retour aux Sources Aldi","product_url":"https://essenmitherz.ch/rindfleisch-retour-aux-sources/","tier":"TOP","steps_to_go":6},{"label":"Retour aux sources D","label_url":"https://essenmitherz.ch/label-retour-aux-sources-d/","animal":"eier","product_title":"Eier Retour aux Sources Aldi","product_url":"https://essenmitherz.ch/eier-retour-aux-sources/","tier":"TOP","steps_to_go":10},{"label":"Retour aux sources D","label_url":"https://essenmitherz.ch/label-retour-aux-sources-d/","animal":"milch","product_title":"Milch Retour aux Sources Aldi","product_url":"https://essenmitherz.ch/milch-retour-aux-sources/","tier":"TOP","steps_to_go":13},{"label":"SILVESTRI ALPSCHWEIN D","label_url":"https://essenmitherz.ch/label-silvestri-alpschwein/","animal":"schweinefleisch","product_title":"Alpschwein Silvestri IP-SUISSE","product_url":"https://essenmitherz.ch/schweinefleisch-alpschwein-ip-suisse/","tier":"TOP","steps_to_go":13},{"label":"SILVESTRI FREILANDSCHWEIN D","label_url":"https://essenmitherz.ch/label-silvestri-freilandschwein","animal":"schweinefleisch","product_title":"Schweinefleisch Silvestri Freilandschwein","product_url":"https://essenmitherz.ch/schweinefleisch-silvestri-freilandschwein/","tier":"TOP","steps_to_go":13},{"label":"SILVESTRI BIO-WEIDERIND D","label_url":"https://essenmitherz.ch/label-silvestri-weiderind-2/","animal":"rindfleisch","product_title":"Rindfleisch Silvestri Bio-Weiderind","product_url":"https://essenmitherz.ch/rindfleisch-weidebeef-silvestri-weiderind/","tier":"TOP","steps_to_go":7},{"label":"SILVESTRI WEIDERIND D","label_url":"https://essenmitherz.ch/label-silvestri-weiderind/","animal":"rindfleisch","product_title":"Rindfleisch Silvestri Weiderind","product_url":"https://essenmitherz.ch/rindfleisch-weidebeef-silvestri-weiderind-2/","tier":"TOP","steps_to_go":13},{"label":"SUISSE GARANTIE D","label_url":"https://essenmitherz.ch/label-suisse-garantie/","animal":"rindfleisch","product_title":"Rindfleisch Suisse Garantie","product_url":"https://essenmitherz.ch/rindfleisch-suisse-garantie/","tier":"UNCOOL","steps_to_go":35},{"label":"SUISSE GARANTIE D","label_url":"https://essenmitherz.ch/label-suisse-garantie/","animal":"kalbfleisch","product_title":"Kalbfleisch Suisse Garantie","product_url":"https://essenmitherz.ch/kalbfleisch-suisse-garantie/","tier":"UNCOOL","steps_to_go":35},{"label":"SUISSE GARANTIE D","label_url":"https://essenmitherz.ch/label-suisse-garantie/","animal":"poulet","product_title":"Pouletfleisch Suisse Garantie","product_url":"https://essenmitherz.ch/pouletfleisch-suisse-garantie/","tier":"UNCOOL","steps_to_go":32},{"label":"SUISSE GARANTIE D","label_url":"https://essenmitherz.ch/label-suisse-garantie/","animal":"eier","product_title":"Eier Suisse Garantie Freiland","product_url":"https://essenmitherz.ch/eier-suisse-garantie-freiland/","tier":"OK","steps_to_go":22},{"label":"SUISSE GARANTIE D","label_url":"https://essenmitherz.ch/label-suisse-garantie/","animal":"eier","product_title":"Eier Suisse Garantie Bodenhaltung","product_url":"https://essenmitherz.ch/eier-suisse-garantie-bodenhaltung/","tier":"UNCOOL","steps_to_go":31},{"label":"SUISSE GARANTIE D","label_url":"https://essenmitherz.ch/label-suisse-garantie/","animal":"milch","product_title":"Milch Suisse Garantie","product_url":"https://essenmitherz.ch/milch-suisse-garantie/","tier":"UNCOOL","steps_to_go":36},{"label":"SWISS BLACK ANGUS D","label_url":"https://essenmitherz.ch/label-swiss-black-angus/","animal":"rindfleisch","product_title":"Rindfleisch Swiss Black Angus","product_url":"https://essenmitherz.ch/rindfleisch-swiss-black-angus-ip-suisse/","tier":"TOP","steps_to_go":13}];

// Deduplicate DB by product_url at load time (#1)
const DB_DEDUPED = (() => {
  const seen = new Set();
  return DB.filter(i => {
    if (seen.has(i.product_url)) return false;
    seen.add(i.product_url);
    return true;
  });
})();

// State
let currentFilter = 'alle';
let recentScans = [];
let scanTimeout = null;

// Icons8 icon URLs (Windows 10 / Fluent style)
const ANIMAL_ICON = {
  rindfleisch: `<img src="https://img.icons8.com/?size=96&id=19357&format=png" alt="Rind">`,
  kalbfleisch: `<img src="https://img.icons8.com/?size=96&id=19357&format=png" alt="Kalb">`,
  schweinefleisch: `<img src="https://img.icons8.com/?size=96&id=19829&format=png" alt="Schwein">`,
  poulet: `<img src="https://img.icons8.com/?size=96&id=19354&format=png" alt="Poulet">`,
  eier: `<img src="https://img.icons8.com/?size=96&id=-LAAHSbUGyhn&format=png" alt="Eier">`,
  milch: `<img src="https://img.icons8.com/?size=96&id=18282&format=png" alt="Milch">`
};

const ANIMAL_ICON_FALLBACK = `<img src="https://img.icons8.com/?size=96&id=11795&format=png" alt="Produkt">`;

const ANIMAL_LABEL = {
  rindfleisch: 'Rindfleisch',
  kalbfleisch: 'Kalbfleisch',
  schweinefleisch: 'Schweinefleisch',
  poulet: 'Poulet',
  eier: 'Eier',
  milch: 'Milch'
};

const TIER_EXPLAIN = {
  TOP: { title: 'Bevorzugen', text: 'Sehr gute Vorgaben. Wenn solche Produkte zu haben sind, sollte man zugreifen.' },
  OK: { title: 'Empfehlenswert', text: 'Gute Vorgaben. Man darf zugreifen aus Sicht des Schweizer Tierschutz STS.' },
  UNCOOL: { title: 'Wenn\u2019s sein muss', text: 'Ungen\u00fcgende Vorgaben. Sonst lieber im Regal stehen lassen.' },
  'NO GO': { title: 'Finger weg', text: 'Schlechte bis gar keine Vorgaben. Von solchen Produkten sollte man die Finger lassen.' }
};

const TIER_COLORS = {
  TOP: { class: 'top', hex: '#3D8B6E' },
  OK: { class: 'ok', hex: '#C8956C' },
  UNCOOL: { class: 'uncool', hex: '#CB6B4A' },
  'NO GO': { class: 'nogo', hex: '#943338' }
};

const MAX_STEPS = 40;

// Clean label name (remove trailing " D", " DE")
function cleanLabel(label) {
  return label.replace(/\s+D$/, '').replace(/\s+DE$/, '').trim();
}

// Navigate
function showScreen(name) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  const screen = document.getElementById('screen-' + name);
  screen.classList.add('active');
  screen.scrollTop = 0;
  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
  const navBtn = document.querySelector(`.nav-item[data-screen="${name}"]`);
  if (navBtn) navBtn.classList.add('active');
}

function navTo(btn) {
  const screen = btn.dataset.screen;
  showScreen(screen);
  if (screen === 'db') renderDB();
}

// Scan
function startScan() {
  showScreen('analyzing');
  if (scanTimeout) clearTimeout(scanTimeout);
  scanTimeout = setTimeout(() => {
    scanTimeout = null;
    const active = document.getElementById('screen-analyzing').classList.contains('active');
    if (!active) return;
    const item = DB_DEDUPED[Math.floor(Math.random() * DB_DEDUPED.length)];
    showResult(item);
  }, 2200);
}

function showResult(item) {
  const tier = item.tier || 'OK';
  const tc = TIER_COLORS[tier] || TIER_COLORS.OK;

  document.getElementById('result-label').textContent = cleanLabel(item.label);
  document.getElementById('result-product').textContent = item.product_title;

  const icon = ANIMAL_ICON[item.animal] || ANIMAL_ICON_FALLBACK;
  const animalLabel = ANIMAL_LABEL[item.animal] || item.animal || 'Produkt';
  document.getElementById('result-animal').innerHTML = `<span class="result-animal-icon">${icon}</span> ${animalLabel}`;

  // Score ring
  const scoreTier = document.getElementById('score-tier');
  scoreTier.textContent = tier;
  scoreTier.className = 'score-tier-label tier-' + tc.class;

  const ringFill = document.getElementById('score-ring-fill');
  ringFill.style.stroke = tc.hex;
  const circumference = 326.73;
  const stepsNorm = Math.min((item.steps_to_go || 20) / MAX_STEPS, 1);
  const score = 1 - stepsNorm;
  ringFill.style.strokeDashoffset = circumference;
  requestAnimationFrame(() => {
    requestAnimationFrame(() => {
      ringFill.style.strokeDashoffset = circumference * (1 - score);
    });
  });

  // Steps
  const scorePercent = Math.round(score * 100);
  document.getElementById('steps-value').textContent = `${scorePercent}%`;
  const stepsFill = document.getElementById('steps-fill');
  stepsFill.style.background = tc.hex;
  stepsFill.style.width = '0%';
  requestAnimationFrame(() => {
    requestAnimationFrame(() => {
      stepsFill.style.width = (score * 100) + '%';
    });
  });

  // Tier explanation
  const explain = TIER_EXPLAIN[tier] || TIER_EXPLAIN.OK;
  const explainEl = document.getElementById('tier-explain');
  explainEl.className = 'tier-explain tier-' + tc.class + '-border';
  document.getElementById('tier-explain-title').textContent = explain.title;
  document.getElementById('tier-explain-text').textContent = explain.text;

  // Link
  document.getElementById('result-link').href = item.product_url || '#';

  showScreen('result');

  // Add to recent
  recentScans.unshift(item);
  if (recentScans.length > 5) recentScans.pop();
  renderRecent();
}

function renderRecent() {
  if (recentScans.length === 0) {
    document.getElementById('recent-section').style.display = 'none';
    return;
  }
  document.getElementById('recent-section').style.display = 'block';
  const container = document.getElementById('recent-items');
  container.innerHTML = recentScans.map(item => {
    const icon = ANIMAL_ICON[item.animal] || ANIMAL_ICON_FALLBACK;
    const tc = TIER_COLORS[item.tier] || TIER_COLORS.OK;
    return `<div class="recent-item" onclick='showResult(${JSON.stringify(item).replace(/'/g,"&#39;")})'>
      <div class="recent-item-emoji">${icon}</div>
      <div class="recent-item-label">${cleanLabel(item.label)}</div>
      <div class="recent-item-tier tier-${tc.class}-bg">${item.tier}</div>
    </div>`;
  }).join('');
}

// Database
function setFilter(btn) {
  document.querySelectorAll('.filter-tab').forEach(t => t.classList.remove('active'));
  btn.classList.add('active');
  currentFilter = btn.dataset.filter;
  renderDB();
}

function filterDB() {
  renderDB();
}

function renderDB() {
  const search = (document.getElementById('db-search-input').value || '').toLowerCase();
  let items = DB_DEDUPED;

  if (currentFilter !== 'alle') {
    items = items.filter(i => {
      if (i.animal) return i.animal === currentFilter;
      // For null-animal entries, match by product title or label
      const text = ((i.product_title || '') + ' ' + (i.label || '')).toLowerCase();
      return text.includes(currentFilter);
    });
  }

  if (search) {
    items = items.filter(i =>
      (i.label || '').toLowerCase().includes(search) ||
      (i.product_title || '').toLowerCase().includes(search)
    );
  }

  // Sort: TOP first, then by steps
  const tierOrder = { TOP: 0, OK: 1, UNCOOL: 2, 'NO GO': 3 };
  items.sort((a, b) => (tierOrder[a.tier] ?? 4) - (tierOrder[b.tier] ?? 4) || (a.steps_to_go || 99) - (b.steps_to_go || 99));

  document.getElementById('db-count').textContent = `${items.length} Produkte`;

  const list = document.getElementById('db-list');
  if (items.length === 0) {
    list.innerHTML = '<div class="db-empty">Keine Produkte gefunden</div>';
    return;
  }

  list.innerHTML = items.map(item => {
    const icon = ANIMAL_ICON[item.animal] || ANIMAL_ICON_FALLBACK;
    const tc = TIER_COLORS[item.tier] || TIER_COLORS.OK;
    return `<div class="db-card" onclick='showResult(${JSON.stringify(item).replace(/'/g,"&#39;")})'>
      <div class="db-card-emoji">${icon}</div>
      <div class="db-card-info">
        <div class="db-card-label">${cleanLabel(item.label)}</div>
        <div class="db-card-product">${item.product_title}</div>
      </div>
      <div class="db-card-right">
        <div class="db-card-tier tier-${tc.class}-bg">${item.tier}</div>
        <div class="db-card-steps">${Math.round((1 - Math.min((item.steps_to_go || 20) / 40, 1)) * 100)}%</div>
      </div>
    </div>`;
  }).join('');
}

// Init
renderDB();
</script>
</body>
</html>
